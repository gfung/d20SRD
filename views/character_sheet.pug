extends layout

block content
    div.row
        span.col-xs-3#charname Character name : 
        div.row.col-xs-9
            div
                div.col-xs-4
                    span#classlevel Class and Level :                 
                div.col-xs-4
                    span Background : 
                div.col-xs-4
                    span#charrace Race : 
            div
                div.col-xs-4
                    span#charalign Alignment :
                div.col-xs-4
                    span Experience Points :
                div.col-xs-4
    hr
    div.row
        div.col-xs-4
            div
                span#pro_bonus Proficiency Bonus : 
            br
            div
                span#inspiration Inspiration :
            br
            div
                span#Strength Strength : 
                div.col-xs-offset-1#Strengthbonus Bonus : 
                div.col-xs-offset-1#str_save Saving Throw
                div.col-xs-offset-1#skill_Athletics Athletics
            br
            div
                span#Dexterity Dexterity : 
                div.col-xs-offset-1#Dexteritybonus Bonus :
                div.col-xs-offset-1#dex_save Saving Throw
                div.col-xs-offset-1#skill_Acrobatics Acrobatics
                div.col-xs-offset-1#skill_Sleight Sleight of Hand
                div.col-xs-offset-1#skill_Stealth Stealth
            br
            div
                span#Constitution Constitution : 
                div.col-xs-offset-1#Constitutionbonus Bonus :
                div.col-xs-offset-1#con_save Saving Throw
            br
            div
                span#Intelligence Intelligence : 
                div.col-xs-offset-1#Intelligencebonus Bonus :
                div.col-xs-offset-1#int_save Saving Throw
                div.col-xs-offset-1#skill_Arcana Arcana
                div.col-xs-offset-1#skill_History History
                div.col-xs-offset-1#skill_Investigation Investigation
                div.col-xs-offset-1#skill_Nature Nature
                div.col-xs-offset-1#skill_Religion Religion
            br
            div
                span#Wisdom Wisdom : 
                div.col-xs-offset-1#Wisdombonus Bonus :
                div.col-xs-offset-1#wis_save Saving Throw
                div.col-xs-offset-1#skill_Animal Animal Handling
                div.col-xs-offset-1#skill_Insight Insight
                div.col-xs-offset-1#skill_Medicine Medicine
                div.col-xs-offset-1#skill_Perception Perception
                div.col-xs-offset-2#passive_per Passive Perception
                div.col-xs-offset-1#skill_Survival Survival
            br
            div
                span#Charisma Charisma : 
                div.col-xs-offset-1#Charismabonus Bonus :
                div.col-xs-offset-1#cha_save Saving Throw
                div.col-xs-offset-1#skill_Deception Deception
                div.col-xs-offset-1#skill_Intimidation Intimidation
                div.col-xs-offset-1#skill_Performance Performance
                div.col-xs-offset-1#skill_Persuasion Persuasion
        div.col-xs-4
            div.row
                div.col-xs-4(style="text-align: center;") Armor Class
                div.col-xs-4(style="text-align: center;") Initiative
                div.col-xs-4#speed(style="text-align: center;") Speed
            br
            div.row
                div.col-xs-12(style="text-align: center;") Max HP : 
            br
            div.row
                div.col-xs-12(style="text-align: center;") Current HP :
                    <input type="number">
            br
            div.row
                div.col-xs-12(style="text-align: center;") Temporary HP :
                    <input type="number">
            br
            div.row
                div.col-xs-6 Hit Dice
                div.col-xs-6 Death Saves
            br
            div.row
                table.table
                    tr
                        td Name
                        td Atk Bonus (hit)
                        td Damage
                        td Type
                    tr#attacks
        div.col-xs-4
            div
                div Personality Traits
                    div
                        textarea(rows=4)
                div Ideals
                    div
                        textarea(rows=4)
                div Bonds
                    div
                        textarea(rows=4)
                div Flaws
                    div
                        textarea(rows=4)
                div 
                    u Features & Traits
                    div#feats
    br
    div.row
        div.col-xs-3
            div#Other 
                u Proficiencies
        div.col-xs-9
            div 
                u Equipment/Items


    script(src='/js/proficiency.js')
    script.
        let csrf = $('[name="csrf-token"]').prop('content')
        let sheet = window.location.pathname.split('/')
        $.post("/player/character_sheet/"+sheet[3], {'_csrf': csrf, 'name': sheet[3]}).then(function(data){ 
            /** 
             * vars 
             */
            let ecl=0;
            console.log(data)
            
            /** 
             * display data 
             */

            //name
            $("#charname").append(data.player_name)
            //race name
            $("#charrace").append(data.player_race.name)
            //char align
            $("#charalign").append(data.player_align) // need to add this
            
            //ability scores
            let abi_scores=[]
            for(let each in data.ability_scores){
                abi_scores.push( data.ability_scores[each] + data.player_race.stat_bonus[each] ) 
            }

            $('#Strength').append(abi_scores[0])
            $('#Strengthbonus').append( ((abi_scores[0]-10)/2) || 0 )
            $('#Dexterity').append(abi_scores[1])
            $('#Dexteritybonus').append( ((abi_scores[1]-10)/2) || 0 )
            $('#Constitution').append(abi_scores[2])
            $('#Constitutionbonus').append( ((abi_scores[2]-10)/2) || 0 )
            $('#Intelligence').append(abi_scores[3])
            $('#Intelligencebonus').append( ((abi_scores[3]-10)/2) || 0 )
            $('#Wisdom').append(abi_scores[4])
            $('#Wisdombonus').append( ((abi_scores[4]-10)/2) || 0 )
            $('#Charisma').append(abi_scores[5])
            $('#Charismabonus').append( ((abi_scores[5]-10)/2) || 0 )
            //check off saving throws
            for (let i=0;i< data.player_class.length;i++){
                for ( let j=0;j<data.player_class[i].pclass.proficiencies.saving_throws.length;j++){
                    $("#"+data.player_class[i].pclass.proficiencies.saving_throws[j]+"_save").append('<i class="fa fa-check" aria-hidden="true"></i>')
                }
            }
            //check off skills
            //check off saving throws
            for (let i=0;i< data.skills.length;i++){
                $("#skill_"+data.skills[i].).append('<i class="fa fa-check" aria-hidden="true"></i>')
            }


            /**
             *  race bonuses
             */
            //languages and feats
            for (let i=0;i < data.player_race.features.length;i++){
                $("#feats").append("<div>"+data.player_race.features[i]+"</div>")
            }
            for (let i=0;i < data.player_race.languages.length;i++){
                $("#Other").append("<div>"+data.player_race.languages[i]+"</div>")
            }

            /**
             *  class bonuses
             */

            //skills


            //levels and ECL
            for (let i =0;i < data.player_class.length;i++){
                //get class levels and ecl
                $("#classlevel").append(data.player_class[i].pclass.name+" "+data.player_class[i].pclass_level)
                ecl += data.player_class[i].pclass_level
                //get features
                
            }
            $("#classlevel").append(" ECL"+ecl)
            $("#pro_bonus").append(probonus(5, ecl))
            $("#classlevel").append(data.player_class[0])
        })